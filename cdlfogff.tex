\input{header}
\title{Computing Dirichlet L-functions over global function fields}
\subtitle{Young Researchers in Algebraic Number Theory}
\author{David Kurniadi Angdinata}
\institute{London School of Geometry and Number Theory}
\date{Thursday, 4 September 2025}

\begin{document}

\frame\maketitle

\begin{frame}{Dirichlet characters and L-functions over $ \F_p(t) $}

A Dirichlet character of modulus $ m \in \Z $ is a map $ \chi_m : (\Z / m)^\times \to \C^\times $.

\bigskip For a fixed ring of integers $ \F_p[t] $ of $ \F_p(t) $, a \textbf{Dirichlet character of modulus $ m \in \F_p[t] $} is a map $ \chi_m : (\F_p[t] / m)^\times \to \C^\times $.

\bigskip In both cases, their \textbf{(incomplete) Dirichlet L-function} is
$$ L(\chi_m, s) := \prod_{v \nmid m} \dfrac{1}{1 - \chi_m(v)p_v^{-s\deg v}}. $$

\begin{conjecture}[Generalised extended Riemann hypothesis]
The non-trivial zeroes of $ L(\chi_m, s) $ have real part equal to $ \tfrac{1}{2} $.
\end{conjecture}

\bigskip Frustration: there are many implementations of Dirichlet characters and L-functions over number fields, but none over global function fields!

\end{frame}

\begin{frame}{Structure of units over $ \Q $}

For a modulus $ m $ in either $ R = \Q $ or $ R = \F_p[t] $, writing $ m = m_1^{e_1} \cdot \dots \cdot m_r^{e_r} $ as a product of prime powers gives an isomorphism of abelian groups
$$ \Hom((R / m)^\times, \C^\times) \cong \prod_{k = 1}^r \Hom((R / m_k^{e_k})^\times, \C^\times), $$
so it suffices to consider $ \chi_{m^e} $ when $ m \in R $ is prime.

\bigskip

\begin{lemma}
Let $ m \in \Z $ be prime. Then
$$ (\Z / m^e)^\times \cong
\begin{cases}
C_2 \times C_{2^{e - 2}} & \text{if} \ m = 2 \ \text{and} \ e \ge 3, \\
C_{m^{e - 1}(m^e - 1)} & \text{otherwise}.
\end{cases}
$$
\end{lemma}

Over $ \Q $, Dirichlet characters are determined by its values on generators.

\end{frame}

\begin{frame}{Structure of units over $ \F_p(t) $}

When $ m \in \F_p[t] $ is prime, $ (\F_p[t] / m^e)^\times $ is far from cyclic in general.
$$
\begin{array}{|c|c|}
\hline
e & (\F_2[t] / t^e)^\times \\
\hline
1 & C_1 \\
2 & C_2 \\
3 & C_4 \\
4 & C_2 \times C_4 \\
5 & C_2 \times C_8 \\
6 & C_2^2 \times C_8 \\
7 & C_2 \times C_4 \times C_8 \\
8 & C_2^2 \times C_4 \times C_8 \\
9 & C_2^2 \times C_4 \times C_{16} \\
10 & C_2^3 \times C_4 \times C_{16} \\
11 & C_2^2 \times C_4^2 \times C_{16} \\
12 & C_2^3 \times C_4^2 \times C_{16} \\
13 & C_2^3 \times C_4 \times C_8 \times C_{16} \\
\hline
\end{array}
\qquad
\begin{array}{|c|c|}
\hline
e & (\F_3[t] / t^e)^\times \\
\hline
1 & C_2 \\
2 & C_2 \times C_3 \\
3 & C_2 \times C_3^2 \\
4 & C_2 \times C_3 \times C_9 \\
5 & C_2 \times C_3^2 \times C_9 \\
6 & C_2 \times C_3^3 \times C_9 \\
7 & C_2 \times C_3^2 \times C_9^2 \\
8 & C_2 \times C_3^3 \times C_9^2 \\
9 & C_2 \times C_3^4 \times C_9^2 \\
10 & C_2 \times C_3^4 \times C_9 \times C_{27} \\
11 & C_2 \times C_3^5 \times C_9 \times C_{27} \\
12 & C_2 \times C_3^6 \times C_9 \times C_{27} \\
13 & C_2 \times C_3^5 \times C_9^2 \times C_{27} \\
\hline
\end{array}
$$
Question: where do these partitions come from?

\end{frame}

\begin{frame}{Decomposition into canonical units}

\begin{lemma}
Let $ m \in \F_p[t] $ be prime of degree $ f $, and let $ h \in (\F_p[t] / m)^\times $ be fixed generators. Then for any $ x \in (\F_p[t] / m^e)^\times $, there are unique exponents $ 1 \le a \le p^f - 1 $ and $ 1 \le b_{i, j} \le p $ such that
$$ x = h^a \cdot \prod_{i = 1}^{e - 1} \prod_{j = 0}^{f - 1} (1 + t^jm^i)^{b_{i, j}}. $$
\vspace{-0.5cm}
\end{lemma}

\begin{proof}[Proof by algorithm]
Apply the division algorithm to give $ y \equiv 1 \mod m $ and $ z \in (\F_p[t] / m)^\times $ such that $ x = y \cdot m + z $. Compute $ a := \log_h\omega_p(z) \in \{1, \dots, p^f - 1\} $, which is unique since $ (\F_p[t] / m)^\times \cong C_{p^f - 1} $. Express $ y $ in base $ m $:
$$ \textstyle y = 1 + (\sum_{j = 0}^{f - 1} b_{1, j}t^j)m + (\sum_{j = 0}^{f - 1} b_{2, j}t^j)m^2 + \dots + (\sum_{j = 0}^{f - 1} b_{e - 1, j}t^j)m^{e - 1}. $$
Replace $ y $ with $ y \cdot \prod_{j = 0}^{f - 1} (1 + t^jm)^{-b_{1, j}} \equiv 1 \mod m^2 $ and repeat.
\end{proof}

\end{frame}

\begin{frame}{Dirichlet character example}

Let $ m := t^2 + 2 \in \F_5[t] $, and let $ \chi_{m^4} : (\F_5[t] / m^4)^\times \to \C^\times $ be the (primitive) Dirichlet character given by
$$
\begin{array}{cccc}
t + 1 \mapsto \zeta_{24}, & 1 + m \mapsto \zeta_5, & 1 + m^2 \mapsto \zeta_5^2, & 1 + m^3 \mapsto \zeta_5^3, \\
& 1 + tm \mapsto \zeta_5^4, & 1 + tm^2 \mapsto \zeta_5^3, & 1 + tm^3 \mapsto \zeta_5^2,
\end{array}
$$
noting that $ (\F_5[t] / m^4)^\times \cong C_{24} \times C_5^6 $. To evaluate $ \chi_{m^4}(t^7 + 1) $, compute
\begin{align*}
t^7 + 1
& = (2t + 1) + 2tm + 4tm^2 + tm^3 \\
& = (2t + 1) \cdot (1 + (2 + 3t)m + 4tm^2 + (4 + 3t)m^3) \\
& = (2t + 1) \cdot (1 + m)^2(1 + tm)^3 \cdot (1 + 3tm^2 + (1 + t)m^3) \\
& = (2t + 1) \cdot (1 + m)^2(1 + tm)^3 \cdot (1 + tm^2)^3 \cdot (1 + (1 + t)m^3) \\
& = (2t + 1) \cdot (1 + m)^2(1 + tm)^3 \cdot (1 + tm^2)^3 \cdot (1 + m^3)(1 + tm^3).
\end{align*}
Then $ 2t + 1 \equiv (t + 1)^{22} \mod m $, so
$$ \chi_{m^4}(t^7 + 1) = \zeta_{24}^{22} \cdot \zeta_5^2(\zeta_5^4)^3 \cdot (\zeta_5^3)^3 \cdot \zeta_5^3\zeta_5^2 = \zeta_{60}^{31}. $$

\end{frame}

\begin{frame}{Dirichlet characters over $ \F_q(C) $}

In general, a global function field is the function field $ \F_q(C) $ of a smooth proper geometrically irreducible curve $ C $ of genus $ g $ over a finite field $ \F_q $.

\bigskip A (primitive) Dirichlet character over $ \F_q(C) $ of modulus $ m \subseteq \OO_v $ really should be a complex character of the \st{ray class group modulo $ m $ (Weber)} \st{id\`ele class group $ I $ trivial on $ 1 + m $ (Hecke)} absolute Galois group $ G := \Gal(\overline{\F_q(C)} / \F_q(C)) $ that factors through a finite abelian extension of $ \F_q(C) $ defined with the Drinfeld module associated to $ m $ (Artin).

\bigskip In particular, Artin reciprocity gives a map $ I \to G $ that sends a place $ v $ of $ \F_q(C) $ to (a choice of) a geometric Frobenius $ \Fr_v^{-1} $ in $ G $.

\bigskip For a Dirichlet character $ \chi_m : G \to \C^\times $, denote
$$ \chi_m(v) :=
\begin{cases}
\chi_m(\Fr_v^{-1}) & \text{if} \ v \ \text{is unramified}, \\
0 & \text{if} \ v \ \text{is ramified}.
\end{cases}
$$

\end{frame}

\begin{frame}{Artin conductors over $ \F_q(C) $}

The \textbf{Artin conductor} of $ \chi_m : G \to \C^\times $ is the effective Weil divisor
$$ \ff(\chi_m) := \sum_v \alpha_v(\chi_m)[v], \qquad \alpha_v(\chi_m) := \sum_{\chi_m(G_{v, i}) \ne 0} \dfrac{1}{[G_{v, 0} : G_{v, i}]} \in \N. $$
where $ v $ runs over all of the closed points of $ C $.

\bigskip When $ C = \P_{\F_q}^1 $, after fixing a place at infinity $ \infty $,
$$ \{\text{closed points of} \ C\} \quad \leftrightsquigarrow \quad \{\text{primes of} \ \F_q[t]\} \cup \{\infty\}. $$
In fact, it turns out that
$$ \alpha_v(\chi_m) =
\begin{cases}
v(m) & \text{if} \ v \in \F_q[t], \\
1 & \text{if} \ v = \infty \ \text{and} \ \chi_m|_{\F_q^\times} \not\equiv 1, \\
0 & \text{if} \ v = \infty \ \text{and} \ \chi_m|_{\F_q^\times} \equiv 1,
\end{cases}
$$
and in the final case $ \chi_m(\infty) = 1 $.

\end{frame}

\begin{frame}{Dirichlet L-functions over $ \F_q(C) $}

The \textbf{formal L-function} of $ \chi_m : G \to \C^\times $ is the power series
$$ \LL(\chi_m, T) := \prod_v (1 - \chi_m(v)T^{\deg v})^{-1} \in \C[[T]], $$
and $ L(\chi_m, s) := \LL(\chi_m, q^{-s}) $ is its \textbf{(complete) Dirichlet L-function}.

\bigskip If $ \{c_{v, n}\}_{n = 0}^\infty $ are the coefficients of $ (1 - \chi_m(v)T^{\deg v})^{-1} $, then
\begin{align*}
\LL(\chi_m, T)
& = \prod_v \left(\sum_{n = 0}^\infty c_{v, n}T^{n\deg v}\right) \\
& = \sum_{n = 0}^\infty \left(\sum_{\deg D = n} c_D\right)T^n,
\end{align*}
where $ c_D := \prod_v c_{v, n_v} $ for any effective Weil divisor $ D = \sum_v n_v[v] $ on $ C $.

\end{frame}

\begin{frame}{Rationality and the functional equation}

On the other hand, $ \LL(\chi_m, T) $ is essentially the $ \zeta $-function of $ C $.

\bigskip

\begin{corollary}[of the Weil conjectures]
Let $ \chi_m : G \to \C^\times $ be a Dirichlet character over $ \F_q(C) $ that is ramified somewhere. Then $ \LL(\chi_m, T) $ is a polynomial of degree
$$ d(\chi_m) := 2g - 2 + \deg\ff(\chi_m). $$
Furthermore, $ \LL(\chi_m, T) $ satisfies the functional equation
$$ \LL(\chi_m, T) = \epsilon(\chi_m) \cdot (\sqrt{q}T)^{d(\chi_m)} \cdot \overline{\LL(\chi_m, (qT)^{-1})}, $$
for some root number $ \epsilon(\chi_m) \in \C^\times $ defined with Gauss sums.
\end{corollary}

\bigskip The fact that $ \deg\LL(\chi_m, T) = d(\chi_m) $ means that it is determined by its coefficients $ c_D $ for all effective Weil divisors $ D $ on $ C $ with $ \deg D \le d(\chi_m) $.

\end{frame}

\begin{frame}{Dirichlet L-function example with rationality}

Let $ m := t^3 + 2t + 1 \in \F_3[t] $, and let $ \chi_m : (\F_3[t] / m)^\times \to \C^\times $ be the (primitive) Dirichlet character given by $ t \mapsto \zeta := \zeta_{26} $. Then
$$ \deg\LL(\chi_m, T) = d(\chi_m) = 2(0) - 2 + \deg([m] + [\infty]) = 2. $$
$$
\begin{array}{|c|c|c|c|}
\hline
v & 1 - \chi_m(v)T & 1 - \chi_m(v)T^{\deg v} & (1 - \chi_m(v)T^{\deg v})^{-1} \\
\hline
\infty & 1 & 1 & 1 \\
\hline
t & 1 - \zeta T & 1 - \zeta T & 1 + \zeta T + \zeta^2T^2 + \dots \\
\hline
t + 1 & 1 - \zeta^9T & 1 - \zeta^9T & 1 + \zeta^9T + \zeta^{18}T^2 + \dots \\
\hline
t + 2 & 1 - \zeta^3T & 1 - \zeta^3T & 1 + \zeta^3T + \zeta^6T^2 + \dots \\
\hline
t^2 + 1 & 1 - \zeta^{21}T & 1 - \zeta^{21}T^2 & 1 + \zeta^{21}T^2 + \dots \\
\hline
t^2 + t + 2 & 1 - \zeta^{11}T & 1 - \zeta^{11}T^2 & 1 + \zeta^{11}T^2 + \dots \\
\hline
t^2 + 2t + 2 & 1 - \zeta^7T & 1 - \zeta^7T^2 & 1 + \zeta^7T^2 + \dots \\
\hline
\end{array}
$$
The product of $ (1 - \chi_m(v)T^{\deg v})^{-1} $ computes to be
$$ 1 + (\zeta^9 + \zeta^3 + \zeta)T + (2\zeta^{11} + \zeta^9 - 2\zeta^8 + 2\zeta^7 + \zeta^3 + \zeta - 1)T^2 + \dots. $$
Thus $ \LL(\chi_m, T) $ is just the first three terms!

\end{frame}

\begin{frame}{Application of the functional equation}

The functional equation $ \LL(\chi_m, T) = \epsilon(\chi_m) \cdot (\sqrt{q}T)^{d(\chi_m)} \cdot \overline{\LL(\chi_m, (qT)^{-1})} $ reduces the required computation by $ \lfloor d(\chi_m) / 2\rfloor $.

\bigskip If $ \{c_n\}_{n = 0}^{d(\chi_m)} $ are the coefficients of $ \LL(\chi_m, T) $, then this says
\begin{align*}
\sum_{n = 0}^{d(\chi_m)} (c_n \cdot T^n)
& = \sum_{n = 0}^{d(\chi_m)} (\epsilon(\chi_m) \cdot \sqrt{q}^{d(\chi_m) - 2n} \cdot \overline{c_n} \cdot T^{d(\chi_m) - n}) \\
& = \sum_{n = 0}^{d(\chi_m)} (\epsilon(\chi_m) \cdot \sqrt{q}^{2n - d(\chi_m)} \cdot \overline{c_{d(\chi_m) - n}} \cdot T^n).
\end{align*}
In other words, when $ \lceil d(\chi_m) / 2\rceil \le n \le d(\chi_m) $,
$$ c_n = \epsilon(\chi_m) \cdot \sqrt{q}^{2n - d(\chi_m)} \cdot \overline{c_{d(\chi_m) - n}}, $$
so $ \LL(\chi_m, T) $ is determined by its coefficients $ c_D $ for all effective Weil divisors $ D $ on $ C $ with $ \deg D \le \lfloor d(\chi_m) / 2\rfloor $ once $ \epsilon(\chi_m) $ is computed.

\end{frame}

\begin{frame}{Dirichlet L-function example with functional equation}

Let $ m := t^3 + 2t + 1 \in \F_3[t] $, and let $ \chi_{m^2} : (\F_3[t] / m^2)^\times \to \C^\times $ be the (primitive) Dirichlet character given by
$$ t \mapsto \zeta_{13}, \qquad 1 + m \mapsto \zeta_3, \qquad 1 + tm \mapsto \zeta_3^2, \qquad 1 + t^2m \mapsto \zeta_3, $$
noting that $ (\F_3[t] / m^2)^\times \cong C_{26} \times C_3^3 $ and $ \chi_{m^2}(2) = 1 $. Then
$$ \deg\LL(\chi_{m^2}, T) = d(\chi_{m^2}) = 2(0) - 2 + \deg(2[m]) = 4. $$
By a similar computation as before,
$$ \LL(\chi_{m^2}, T) \equiv 1 + ZT - (Z + 1)T^2 \mod T^3, $$
where $ Z := \zeta_{13}^9 + \zeta_{13}^3 + \zeta_{13} $. This forces $ Z + 1 = \epsilon(\chi_m) \cdot \overline{(Z + 1)} $! Thus
$$ \LL(\chi_{m^2}, T) = 1 + ZT - (Z + 1)T^2 + 3\epsilon(\chi_m)\overline{Z}T^3 + 9\epsilon(\chi_m)T^4. $$
Alternatively, $ \epsilon(\chi_m) $ can be computed manually, in which case it suffices to determine the first two terms of $ \LL(\chi_{m^2}, T) $.

\end{frame}

\begin{frame}{Motivic L-functions over $ \F_q(C) $}

In general, the formal L-function of an almost everywhere unramified $ \ell $-adic representation $ \rho : G \to \GL_n(\overline{\Q_\ell}) $ over $ \F_q(C) $ is given by
$$ \LL(\rho, T) := \prod_v \det(1 - \rho^{I_v}(v)T^{\deg v})^{-1} \in \overline{\Q_\ell}[[T]]. $$

\begin{corollary}[of the proof of the Weil conjectures]
Let $ \rho : G \to \GL_n(\overline{\Q_\ell}) $ be an $ \ell $-adic representation over $ \F_q(C) $ that is ramified somewhere. Then $ \LL(\rho, T) $ is a polynomial of degree
$$ d(\rho) := (2g - 2)\dim\rho + \deg\ff(\rho). $$
Furthermore, $ \LL(\rho, T) $ satisfies the functional equation
$$ \LL(\rho, T) = \epsilon(\rho) \cdot (q^{(w(\rho) + 1) / 2}T)^{d(\rho)} \cdot \LL(\rho, 1 / q^{w(\rho) + 1}T)^{g(\rho)}, $$
where $ w(\rho) $ is the weight of $ \rho $ and $ g(\rho) $ is some automorphism on $ \overline{\Q_\ell} $.
\end{corollary}

\end{frame}

\begin{frame}{Concluding remarks}

I have implemented Magma intrinsics for computing formal L-functions of general $ \ell $-adic representations over $ \F_q(C) $, including specific examples:
\begin{itemize}
\item Dirichlet characters with semi-efficient root numbers
\item elliptic curves with efficient root numbers except when $ q = 2, 3 $, which is faster than existing functionality when $ q = 2, 3, 5, 7 $
\item tensor products with coprime conductors
\end{itemize}

\begin{theorem}
Let $ \rho, \sigma : G \to \GL_n(\overline{\Q_\ell}) $ be $ \ell $-adic representations of $ \F_q(C) $ with coprime Artin conductors. Then $ \deg\ff(\rho \otimes \sigma) = \deg\ff(\rho)\dim\sigma + \deg\ff(\sigma)\dim\rho $ and
$$ \epsilon(\rho \otimes \sigma) = \epsilon(\rho)^{\dim\sigma} \cdot \epsilon(\sigma)^{\dim\rho} \cdot \dfrac{\det\sigma(\ff(\rho))}{|\det\sigma(\ff(\rho))|} \cdot \dfrac{\det\rho(\ff(\sigma))}{|\det\rho(\ff(\sigma))|}. $$
\end{theorem}

I believe that having a systematic method to compute formal L-functions will be useful in creating databases of motives over global function fields!

\end{frame}

\end{document}