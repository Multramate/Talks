\def\type{}
\input{header}
\title{A unique pair of triangles}
\author{David Kurniadi Angdinata}
\date{Wednesday, 12 November 2025}

\begin{document}

\maketitle

\begin{abstract}
This short note recounts a recent result of Hirakawa and Matsumura.
\end{abstract}

\begin{theorem}[Hirakawa--Matsumura\footnote{\textbf{Y Hirakawa and H Matsumura}. A unique pair of triangles. \emph{Journal of Number Theory} 194 (2019), 297--302}]
Up to similarity, there is a unique pair of a rational right triangle $ R_0 := (135, 352, 377) $ and a rational isosceles triangle $ I_0 := (132, 366, 366) $ with equal perimeter and area.
\end{theorem}

Integral right triangles are parameterised by Pythagorean triples $ (2kmn, k(m^2 - n^2), k(m^2 + n^2)) $ for some $ k, m, n \in \N $. By setting $ q := n / m $, this also parameterises rational right triangles by
$$ R = (2rq, r(1 - q^2), r(1 + q^2)), \qquad q, r \in \Q. $$
This has perimeter $ 2r(1 + q) $ and area $ r^2q(1 - q^2) $. On the other hand, every rational isosceles triangle is the union of two identical right triangles, glued along a side adjacent to their right angles. If this adjacent side were parameterised by $ 2wx $ for some $ w, x \in \Q $, then the corresponding rational triangle is given by
$$ I = (2w(1 - x^2), w(1 + x^2), w(1 + x^2)), \qquad w, x \in \Q. $$
This has perimeter $ 4w $ and area $ 2w^2x(1 - x^2) $. Otherwise, this adjacent side is necessarily parameterised by $ u(1 - v^2) $ for some $ u, v \in \Q $, and the corresponding rational isosceles triangle is given by
$$ (4uv, u(1 + v^2), u(1 + v^2)), \qquad u, v \in \Q. $$
However, this can also be recovered from $ I $ by setting $ w := u(1 + v)^2 / 2 $ and $ x := |(1 - v) / (1 + v)| $, so it suffices to consider pairs of triangles $ (R, I) $. By setting $ z := r / w $ and equating the perimeters and areas,
$$ z(1 + q) = 2, \qquad z^2q(1 - q^2) = 2x(1 - x^2). $$
The first equation says $ q = 2 / z - 1 $, so substituting it into the second gives $ 2z^2 - (x^3 - x + 6)z + 4 = 0 $. Since $ z \in \Q $, the discriminant of $ 2z^2 - (x^3 - x + 6)z + 4 $ as a polynomial in $ z $ is a square, or in other words that
$$ y^2 = (x^3 - x + 6)^2 - 32, \qquad y \in \Q. $$
This equation cuts out an affine curve, and its non-singular compactification defines a hyperelliptic curve of genus two. In general, a \emph{nice curve} $ C $ over a field $ F $ will be a smooth proper geometrically integral scheme of dimension one over $ F $, and its \emph{genus} $ g_C \in \N $ is the dimension of the first cohomology group of its structure sheaf as a vector space over $ F $. A nice curve $ C $ over $ F $ is \emph{hyperelliptic} if it admits a degree two morphism to the projective line, so it is the union of the affine curve $ y^2 = f(x) $ for some square-free polynomial $ f(x) \in F[x] $ of degree $ d \in \{2g_C + 1, 2g_C + 2\} $, and the \emph{curve at infinity} $ v^2 = u^{2g_C + 2}f(1 / u) $ glued along $ x = 1 / u $ and $ y = v / u^{g_C + 1} $. By the Riemann--Roch theorem, every nice curve of genus two is hyperelliptic.

Now let $ C $ be a nice curve over $ \Q $ with $ g_C > 1 $. Via the Abel--Jacobi map, $ C $ embeds naturally into its \emph{Jacobian variety} $ J_C $, which is an abelian variety of dimension $ g_C $ defined as the moduli space of degree zero divisors on $ C $ up to linear equivalence. By the Mordell--Weil theorem, its group of rational points $ J_C(\Q) $ is finitely generated, so it has a finite \emph{torsion subgroup} $ T_C $ and a \emph{rank} $ r_C \in \N $ such that $ J_C(\Q) \cong T_C \oplus \Z^{r_C} $, so in particular $ J_C(\Q) / 2 \cong T_C[2] \oplus \F_2^{r_C} $. This in turn injects into the $ 2 $-Selmer group $ S_2(J_C(\Q)) $, which is a finite-dimensional vector space over $ \F_2 $ that is computable in principle.

\pagebreak

Let $ p \in \N $ be a prime. It turns out that the base change $ C_p $ of $ C $ to $ \Q_p $ has a unique \emph{minimal model} $ \CC_p $ over $ \Z_p $. This is a flat proper regular scheme over $ \Z_p $ whose base change to $ \Q_p $ is $ C_p $, and it is minimal with respect to the partial ordering induced by morphisms of models over $ \Z_p $. Then $ C $ is said to have \emph{good reduction} at $ p $ if the base change $ \widetilde{\CC}_p $ of $ \CC_p $ to $ \F_p $ is a nice curve over $ \F_p $. If $ C $ happens to be cut out by a polynomial over $ \Z $, then $ \widetilde{\CC}_p $ can be obtained from $ C $ simply by reducing its coefficients modulo $ p $. For instance, if $ C $ is hyperelliptic given by an equation $ y^2 = f(x) $ for some $ f(x) \in \Z[x] $, then $ C $ has good reduction at $ p > 2 $ precisely if it does not divide the discriminant of $ f(x) $.

Mordell conjectured that its set of rational points $ C(\Q) $ is finite, and this was subsequently proved by Faltings using deep results in algebraic geometry. However, his proof is \emph{ineffective}, in the sense that it does not give a recipe to determine $ C(\Q) $. Coleman, building upon the work of Chabauty, proved an effective version of Mordell's conjecture under certain assumptions.

\begin{theorem}[Chabauty--Coleman\footnote{\textbf{Robert Coleman}. Effective Chabauty. \emph{Duke Mathematical Journal} 52 (1985), no. 3, 765--770}]
Let $ C $ be a nice curve over $ \Q $ with $ g_C > 1 $ and $ g_C > r_C $ such that $ C $ has good reduction at some prime $ p > 2g_C $. Then $ \#C(\Q) \le \#\widetilde{\CC}_p(\F_p) + (2g_C - 2) $.
\end{theorem}

The key idea is that $ C(\Q) $ can be embedded into the compact space $ J_{C_p}(\Q_p) $ in two ways. On one hand, it can be embedded into $ J_C(\Q) $, whose $ p $-adic closure in $ J_{C_p}(\Q_p) $ defines a $ p $-adic submanifold of dimension at most $ r_C $. On the other hand, it can be embedded into $ C_p(\Q_p) $, whose inclusion into $ J_{C_p}(\Q_p) $ via the Abel--Jacobi map defines a one-dimensional $ p $-adic submanifold. In particular, their intersection in a $ p $-adic manifold of dimension $ g_C > r_C $ should be discrete, which was what Chabauty proved, and hence finite.

Coleman refined this idea by introducing a theory of $ p $-adic integration. Let $ \omega $ be a non-zero differential form on $ C $ that reduces to a non-zero differential form on $ \widetilde{\CC}_p $. By the theory of Newton polygons, any point $ P \in \widetilde{\CC}_p(\F_p) $ in $ C(\Q) $ has at most $ 1 + \ord_P\omega $ preimages in $ C(\Q) $ whenever $ C $ has good reduction at some prime $ p > 2 + \ord_P\omega $, so that by the Riemann--Roch theorem,
$$ \#C(\Q) \le \sum_{P \in \widetilde{\CC}_p(\F_p)} (1 + \ord_P\omega) \le \#\widetilde{\CC}_p(\F_p) + (2g_C - 2). $$
The assumption $ p > 2 + \ord_P\omega $ then holds precisely because $ p > 2g_C $.

Now let $ C $ be the hyperelliptic curve over $ \Q $ with $ g_C = 2 $ defined as the union of the affine curve $ C_0 $ given by $ y^2 = f(x) := (x^3 - x + 6)^2 - 32 $, and the curve at infinity $ C_\infty $ given by $ v^2 = (1 - u + 6u^3)^2 - 32u^6 $. By setting $ u = 0 $, there are only two points $ \infty_+ := (0, 1) $ and $ \infty_- := (0, -1) $ in $ C_\infty \setminus C_0 $, and there are eight obvious points in $ C_0 $ that can be computed by searching in a bounded box, which are tabulated as follows.
$$
\begin{array}{|c|c|c|c|}
\hline
(x, y) & R & I & (\widetilde{x}, \widetilde{y}) \\
\hline
(0, 2) & (0, 2, 2) & (2, 1, 1) & (0, 2) \\
(0, -2) & (2, 0, 2) & (2, 1, 1) & (0, 3) \\
(1, 2) & (0, 2, 2) & (0, 2, 2) & (1, 2) \\
(1, -2) & (2, 0, 2) & (0, 2, 2) & (1, 3) \\
(-1, 2) & (0, 2, 2) & (4, 2, 2) & (4, 2) \\
(-1, -2) & (2, 0, 2) & (4, 2, 2) & (4, 3) \\[0.1cm]
\left(\tfrac{5}{6}, \tfrac{217}{216}\right) & \left(\tfrac{5}{8}, \tfrac{44}{27}, \tfrac{377}{216}\right) & \left(\tfrac{11}{18}, \tfrac{61}{36}, \tfrac{61}{36}\right) & (0, 2) \\[0.1cm]
\left(\tfrac{5}{6}, -\tfrac{217}{216}\right) & \left(\tfrac{44}{27}, \tfrac{5}{8}, \tfrac{377}{216}\right) & \left(\tfrac{11}{18}, \tfrac{61}{36}, \tfrac{61}{36}\right) & (0, 3) \\[0.1cm]
\hline
\end{array}
$$
The first six points do not correspond to well-defined triangles, as in each case $ R $ has a side with zero length, while the final two points correspond to triangles similar to $ R_0 = (135, 352, 377) $ and $ I_0 = (132, 366, 366) $.

Now the discriminant of $ f(x) $ computes to be $ 2^{27} \cdot 47 $, so $ C $ has good reduction at $ 5 > 2g_C $. The obvious points in $ C_0 $ reduce to six distinct points in the affine curve of $ \widetilde{\CC}_5 $ tabulated above as $ (\widetilde{x}, \widetilde{y}) $, while $ \infty_\pm $ reduce to two distinct points in the curve at infinity of $ \widetilde{\CC}_5 $, and these are all of $ \widetilde{\CC}_5(\F_5) $. Furthermore, $ T_C[2] $ contains a point corresponding to the degree zero divisor
$$ [(-1 + \sqrt{2}, 0)] + [(-1 - \sqrt{2}, 0)] - [\infty_1] - [\infty_2], $$
and $ S_2(J_C(\Q)) $ can be computed to be $ \F_2 \oplus \F_2 $, so $ r_C \le 2 - 1 < g_C $. In particular, the assumptions of the Chabauty--Coleman theorem hold, so $ \#C(\Q) \le (6 + 2) + (2(2) - 2) = 10 $. Thus the ten aforementioned points in $ C(\Q) $ are complete, which proves the Hirakawa--Matsumura theorem.

\end{document}