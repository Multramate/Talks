\input{header}
\title{Ad\`eles and cohomology}
\subtitle{Class field theory}
\author{David Kurniadi Angdinata}
\institute{University College London}
\date{Thursday, 4 July 2024}

\begin{document}

\frame\maketitle

\begin{frame}{The fundamental exact sequence}

Let $ E / F $ be a Galois extension. The \textbf{Brauer group} of $ E / F $ is given by
$$ \Br(E / F) \cong H^2(\Gal(E / F), E^\times). $$

\begin{theorem}[Albert--Brauer--Hasse--Noether]
Let $ K $ be a number field. Then there is a short exact sequence
$$ 0 \to \Br(\overline{K} / K) \to \bigoplus_v \Br(\overline{K_v} / K_v) \to \Q / \Z \to 0. $$
\end{theorem}

Why is this the \textbf{fundamental exact sequence} of class field theory?

\bigskip In fact, it suffices to understand
$$ 0 \to \Br(L / K) \to \bigoplus_v \Br(L_w / K_v) \to \tfrac{1}{\#G}\Z / \Z \to 0, $$
where $ L / K $ is a finite cyclic extension with Galois group $ G $.

\end{frame}

\begin{frame}{The idealic reciprocity law}

Recall that for a modulus $ \mm = \mm_0\mm_\infty $ of a number field $ K $,
\begin{itemize}
\item $ I_K(\mm) $ is the ideal group of fractional ideals coprime to $ \mm_0 $, and
\item $ P_K(\mm) $ is the ray subgroup of principal fractional ideals $ (\alpha) $ such that $ \ord_\pp(\alpha - 1) \ge \ord_\pp(\mm) $ for all $ \pp \mid \mm_0 $ and $ \sigma(\alpha) > 0 $ for all $ \sigma \mid \mm_\infty $.
\end{itemize}

\begin{theorem}[global reciprocity]
Let $ L / K $ be a finite abelian extension of number fields with Galois group $ G $. Then there is a surjective \textbf{global Artin map}
$$ \Phi_{L / K} : I_K(\mm) / P_K(\mm) \twoheadrightarrow G, $$
with kernel precisely $ \Nm(I_L(\mm)) $, where $ \mm $ consists of all ramified primes.
\end{theorem}

\begin{theorem}[local reciprocity]
Let $ L_w / K_v $ be a finite abelian extension of non-archimedean local fields with Galois group $ G_v $. Then there is a surjective \textbf{local Artin map}
$$ \phi_{L_w / K_v} : K_v^\times \twoheadrightarrow G_v, $$
with kernel precisely $ \Nm(L_w^\times) $.
\end{theorem}

\end{frame}

\begin{frame}{Id\`eles}

The \textbf{id\`ele group} of $ K $ is defined by
$$ \II_K := \left\{(a_v)_v \in \prod_v K_v^\times : a_v \in \OO_v^\times \ \text{for almost all} \ v\right\}. $$
It is a topological group under the restricted product topology, where a basis of open sets is given by the open sets of the product
$$ \prod_{v \in S} K_v^\times \times \prod_{v \notin S} \OO_v^\times, $$
where $ S $ is a finite set of places of $ K $ containing the archimedean places.

\bigskip There is a natural diagonal embedding $ \Delta : K^\times \hookrightarrow \II_K $, whose image is the \textbf{principal id\`ele subgroup}, and whose cokernel is the \textbf{id\`ele class group}
$$ \CC_K := \II_K / \Delta(K^\times). $$

\end{frame}

\begin{frame}{The id\`elic reciprocity law}

\begin{theorem}[id\`elic reciprocity]
Let $ L / K $ be a finite abelian extension of number fields with Galois group $ G $. Then there is a unique continuous surjection $ \widetilde{\Psi}_{L / K} : \II_K \twoheadrightarrow G $, such that for all places $ w \mid v $, there is a commutative square
$$
\begin{tikzcd}[ampersand replacement=\&]
K_v^\times \arrow[twoheadrightarrow]{r}{\phi_{L_w / K_v}} \arrow[hookrightarrow]{d} \& G_v \arrow[hookrightarrow]{d} \\
\II_K \arrow[twoheadrightarrow]{r}[swap]{\widetilde{\Psi}_{L / K}} \& G.
\end{tikzcd}
$$
Furthermore, it descends to a surjective \textbf{id\`elic Artin map}
$$ \Psi_{L / K} : \CC_K \twoheadrightarrow G, $$
with kernel precisely $ \Nm(\CC_L) $.
\end{theorem}
Note that $ \Psi_{L / K}(a_v) = \Fr_v^{-\ord_v(a_v)} $ for all unramified places $ v $ of $ K $.

\end{frame}

\begin{frame}{The id\`elic Artin map}

\begin{example}[$ K = \Q $ and $ L = \Q(\zeta_{15}) $]
There is an isomorphism of topological groups
$$
\begin{array}{rcrcccl}
\II_\Q & \overset{\sim}{\longrightarrow} & \Q^\times & \times & \R^+ & \times & \displaystyle\prod_p \Z_p^\times \\
(a_\infty, a_2, a_3, a_5, \dots) & \longmapsto & \tfrac{a_\infty}{|a_\infty|}d & & |a_\infty| & & (\tfrac{a_2}{d}, \tfrac{a_3}{d}, \tfrac{a_5}{d}, \dots),
\end{array}
$$
where $ d := \prod_p p^{\ord_p(a_p)} $. This induces:
$$
\begin{tikzcd}[ampersand replacement=\&, column sep=small]
\CC_\Q \arrow{r}{\sim} \arrow[dashed]{dr}[swap]{\Psi_{\Q(\zeta_{15}) / \Q}} \& \R^+ \times \prod_p \Z_p^\times \arrow[twoheadrightarrow]{r} \& \Z_3^\times \times \Z_5^\times \arrow[twoheadrightarrow]{r} \& (\Z_3 / 3\Z_3)^\times \times (\Z_5 / 5\Z_5)^\times \arrow{d}{\sim} \\
\& \Gal(\Q(\zeta_{15}) / \Q) \& (\Z / 15\Z)^\times \arrow{l}{\sim} \& (\Z / 3\Z)^\times \times (\Z / 5\Z)^\times \arrow{l}{\sim}
\end{tikzcd}
$$
The id\`elic Artin map $ \Psi_{\Q(\zeta_{15}) / \Q} : \CC_\Q \to \Gal(\Q(\zeta_{15}) / \Q) $ maps the id\`ele class $ [(1, 2, 1, 1, \dots)] $ to the automorphism $ \zeta_{15} \mapsto \zeta_{15}^{1 / 2} $.
\end{example}

\end{frame}

\begin{frame}{The content map}

There is a surjective \textbf{content map} $ \widetilde{c} : \II_K \twoheadrightarrow I_K $ that maps an id\`ele $ (a_v)_v $ to the ideal $ \prod_\pp \pp^{\ord_\pp(a_\pp)} $, which descends to a surjection $ c : \CC_K \twoheadrightarrow I_K / P_K $.

\begin{lemma}
Let $ G $ be a finite abelian group, and let $ \mm $ be a modulus of a number field $ K $. Then any homomorphism $ \Phi_K : I_K(\mm) \to G $ induces a unique continuous homomorphism $ \Psi_K : \CC_K \to G $ such that
$$ \Psi_K((a_v)_v) = \Phi_K(c((a_v)_v)), $$
for any $ (a_v)_v \in \II_K $ such that $ a_v = 1 $ for all $ v \mid \mm $. Furthermore, any continuous homomorphism $ \Psi_K : \CC_K \to G $ arises in such a way.
\end{lemma}

Since $ \Psi_K $ is a homomorphism, it is determined by id\`eles of the form
$$ (\dots, 1, 1, \underset{v}{a}, 1, 1, \dots), $$
where $ a $ is either a unit or a uniformiser if $ v $ is non-archimedean.

\end{frame}

\begin{frame}{Characters of ideals and id\`eles}

\begin{example}[$ \Phi_\Q : I_\Q(3\infty) \to \Gal(\Q(\zeta_3) / \Q) $]
For brevity, denote $ \{a\} := (\dots, 1, 1, \underset{v}{a}, 1, 1, \dots) $.
\begin{itemize}
\item Let $ v = p \ne 3, \infty $ and $ a = up $. Then $ \{up\}_3 = \{up\}_\infty = 1 $, so
$$ \Psi_\Q(\{up\}) = \Phi_\Q(c(\{up\})) = \Phi_\Q(p^{\ord_p(up)}) = \Phi_\Q(p) = (\zeta_3 \mapsto \zeta_3^p). $$
\item Let $ v = \infty $. Then $ \Psi_\Q(\{a\}) = \Psi_\Q(\Delta(\tfrac{a}{|a|}) \cdot \{a\}) = 1 $, since
$$ \Delta(\tfrac{a}{|a|}) \cdot \{a\} = (\dots, \tfrac{a}{|a|}, \tfrac{a}{|a|}, \underset{\infty}{\tfrac{a}{|a|}a}, \tfrac{a}{|a|}, \tfrac{a}{|a|}, \dots), $$
and $ \R^+ $ is connected while $ \Gal(\Q(\zeta_3) / \Q) $ is discrete.
\item Let $ v = 3 $ and $ a = 3 $. Then $ \Psi_\Q(\{3\}) = \Psi_\Q(\Delta(\tfrac{1}{3}) \cdot \{3\}) = 1 $, since
$$ \Delta(\tfrac{1}{3}) \cdot \{3\} = (\dots, \tfrac{1}{3}, \tfrac{1}{3}, \underset{3}{1}, \tfrac{1}{3}, \tfrac{1}{3}, \dots), $$
and $ \Psi_\Q(\{1\}) = 1 $.
\end{itemize}
\end{example}

\end{frame}

\begin{frame}{Characters of ideals and id\`eles}

\begin{example}[$ \Phi_\Q : I_\Q(3\infty) \to \Gal(\Q(\zeta_3) / \Q) $]
For brevity, denote $ \{a\} := (\dots, 1, 1, \underset{v}{a}, 1, 1, \dots) $.
\begin{itemize}
\item Let $ v = 3 $ and $ a = 2 $. It suffices to find a prime $ p \in \Z $ such that
$$ \Delta(p) \cdot \{2\} = (\dots, p, p, \underset{3}{2p}, \underset{p}{1}, p, p, \dots) \cdot (\dots, 1, 1, \underset{p}{p}, 1, 1, \dots), $$
and that $ 2p \to 1 $ in $ \Z_3 $, so that $ \Psi_\Q(\{2p\}) = 1 $ by continuity. Then
$$ \Psi_\Q(\{2\}) = \Phi_\Q(p) = (\zeta_3 \mapsto \zeta_3^p) = (\zeta_3 \mapsto \zeta_3^2), $$
which does not depend on $ p $. Now $ \tfrac{1}{2} = 2 + \sum_{i = 1}^\infty 3^i $ in $ \Z_3 $, so set
$$ p := 2 + \sum_{i = 1}^{15} 3^i = 21523361, $$
which is prime in $ \Z $, and $ 2p = 1 + 3^{16} \to 1 $ in $ \Z_3 $.
\end{itemize}
\end{example}

\end{frame}

\begin{frame}{Group cohomology}

Let $ G $ be a finite group, and let $ M $ be a $ G $-module. Recall that group cohomology $ H^i(G, -) $ is the right derived functor of $ (-)^G $, where
$$ M^G := \{m \in M : g \cdot m - m = 0 \ \text{for all} \ g \in G\}. $$
The low-dimensional cohomology groups can be made explicit.
\begin{itemize}
\item $ H^0(G, M) $ is just $ M^G $.
\item $ H^1(G, M) $ consists of $ 1 $-cocycles $ f : G \to M $ such that
$$ g \cdot f(h) - f(gh) + f(g) = 0, \qquad g, h \in G, $$
modulo $ 1 $-coboundaries given by $ g \mapsto g \cdot m - m $ for some $ m \in M $.
\item $ H^2(G, M) $ consists of $ 2 $-cocycles $ f : G \times G \to M $ such that
$$ g \cdot f(h, k) - f(gh, k) + f(g, hk) - f(g, h) = 0, \qquad g, h, k \in G, $$
modulo $ 2 $-coboundaries given by $ (g, h) \mapsto g \cdot f(h) - f(gh) + f(g) $ for some $ f : G \to M $.
\end{itemize}

\end{frame}

\begin{frame}{The long exact sequence}

A short exact sequence of $ G $-modules $ 0 \to A \xrightarrow{f} B \xrightarrow{g} C \to 0 $ induces a long exact sequence of cohomology groups
$$ \dots \to H^1(G, B) \xrightarrow{\overline{g}} H^1(G, C) \xrightarrow{\delta} H^2(G, A) \xrightarrow{\overline{f}} H^2(G, B) \to \dots. $$
For a $ 1 $-cocycle $ f \in H^1(G, C) $, the $ 2 $-cocycle $ \delta(f) \in H^2(G, A) $ is given by $ (g, h) \mapsto g \cdot \widetilde{f}(h) - \widetilde{f}(gh) + \widetilde{f}(g) $, where $ \widetilde{f} : G \to B $ is any lift of $ f $.

\begin{example}[$ G = \{1, \sigma, \sigma^2\} $ trivial on $ 0 \to \Z \xrightarrow{\iota} \Q \to \Q / \Z \to 0 $]
Let $ f \in H^1(G, \Q / \Z) $ be given by $ \sigma \mapsto [\tfrac{1}{3}] $. Let $ \widetilde{f} : G \to \Q $ be the lift of $ f $ given by $ \sigma \mapsto \tfrac{1}{3} $. Then $ \delta(f) \in H^2(G, \Z) $ is given by
$$ (g, h) \mapsto
\begin{cases}
1 & \text{if} \ (g, h) = (\sigma, \sigma^2), (\sigma^2, \sigma), (\sigma^2, \sigma^2), \\
0 & \text{otherwise}.
\end{cases}
$$
Note that $ \Q $ is torsion-free and divisible, so $ H^i(G, \Q) = 0 $ for all $ i > 0 $. In particular, there is an isomorphism $ \delta : H^1(G, \Q / \Z) \xrightarrow{\sim} H^2(G, \Z) $.
\end{example}

\end{frame}

\begin{frame}{Tate's theorem}

\begin{theorem}[Tate]
Let $ M $ be a $ G $-module, such that for all subgroups $ H \le G $,
\begin{itemize}
\item[T1] $ H^1(H, M) = 0 $, and
\item[T2] $ H^2(H, M) $ is cyclic of order $ \#H $.
\end{itemize}
Then there is an explicit isomorphism $ G^\ab \xrightarrow{\sim} M^G / \Nm(M) $.
\end{theorem}

\bigskip This is the key result in abstract class field theory.
\begin{itemize}
\item If $ G = \Gal(L_w / K_v) $ and $ M = L_w^\times $, this gives the local reciprocity law
$$ \Gal(L_w / K_v) \xrightarrow{\sim} K_v^\times / \Nm(L_w^\times). $$
\item If $ G = \Gal(L / K) $ and $ M = \CC_L $, this gives the global reciprocity law
$$ \Gal(L / K) \xrightarrow{\sim} \CC_K / \Nm(\CC_L). $$
\end{itemize}

\end{frame}

\begin{frame}{Cohomology of unramified units}

\begin{theorem}[local class field theory]
Let $ L_w / K_v $ be a finite unramified extension of non-archimedean local fields with Galois group $ G_v $. Then $ H^i(G_v, \OO_w^\times) = 0 $ for all $ i > 0 $.
\end{theorem}

The short exact sequence $ 1 \to \OO_w^\times \to L_w^\times \xrightarrow{\ord_w} \Z \to 0 $ induces:

\vspace{-0.5cm}
$$
\begin{tikzcd}[ampersand replacement=\&, column sep=small, row sep=small]
\& \& \overset{0}{\cancel{H^2(G_v, \Q)}} \& \\
\overset{0}{\cancel{H^1(G_v, \OO_w^\times)}} \arrow{r} \& H^2(G_v, L_w^\times) \arrow{r}{\ord_w^*}[swap]{\sim} \& H^2(G_v, \Z) \arrow{u} \arrow{r} \& \overset{0}{\cancel{H^2(G_v, \OO_w^\times)}} \\
\& \& H^1(G_v, \Q / \Z) \arrow{u}{\delta}[swap]{\sim} \arrow{r}{f \mapsto f(1)}[swap]{\sim} \& \tfrac{1}{\#G_v}\Z / \Z \\
\& \& \underset{0}{\cancel{H^1(G_v, \Q)}} \arrow{u} \&
\end{tikzcd}
$$
\vspace{-0.5cm}

In particular, T2 holds for $ L_w^\times $.

\end{frame}

\begin{frame}{The local invariant map}

The \textbf{local invariant map} is $ \inv_v : H^2(G_v, L_w^\times) \to \tfrac{1}{\#G_v}\Z / \Z $.

\begin{example}[$ K_v = \Q_2 $ and $ L_w = \Q_2(\zeta_7) $]
Note that $ G_v = \{1, \sigma, \sigma^2\} $, so that $ \tfrac{1}{\#G_v}\Z / \Z = \{[0], [\tfrac{1}{3}], [\tfrac{2}{3}]\} $. They correspond to the three $ 1 $-cocycles $ f_0, f_1, f_2 \in H^1(G_v, \Q / \Z) $ given by
$$ f_0 : \sigma \mapsto [0], \qquad f_1 : \sigma \mapsto [\tfrac{1}{3}], \qquad f_2 : \sigma \mapsto [\tfrac{2}{3}]. $$
After choosing a lift and applying $ \delta $,
\begin{itemize}
\item $ \delta(f_0) $ is the trivial $ 2 $-cocycle,
\item $ \delta(f_1) $ maps $ (g, h) $ to $ 1 $ iff $ (g, h) = (\sigma, \sigma^2), (\sigma^2, \sigma), (\sigma^2, \sigma^2) $, and
\item $ \delta(f_2) $ maps $ (g, h) $ to $ 1 $ iff $ (g, h) = (\sigma, \sigma^2), (\sigma^2, \sigma), (\sigma, \sigma) $.
\end{itemize}
Since $ \Q_2(\zeta_7)^\times \cong \Z_2[\zeta_7]^\times \times 2^\Z $,
\begin{itemize}
\item $ \inv_2^{-1}[0] $ is the trivial $ 2 $-cocycle,
\item $ \inv_2^{-1}[\tfrac{1}{3}] $ maps $ (g, h) $ to $ 2 $ iff $ (g, h) = (\sigma, \sigma^2), (\sigma^2, \sigma), (\sigma^2, \sigma^2) $, and
\item $ \inv_2^{-1}[\tfrac{2}{3}] $ maps $ (g, h) $ to $ 2 $ iff $ (g, h) = (\sigma, \sigma^2), (\sigma^2, \sigma), (\sigma, \sigma) $.
\end{itemize}
\end{example}

\end{frame}

\begin{frame}{Cohomology of id\`ele classes}

\begin{theorem}[global class field theory]
Let $ L / K $ be a finite extension of number fields with Galois group $ G $. Then $ H^1(G, \CC_L) = 0 $ and $ H^2(G, \CC_L) $ is finite. Furthermore,
\begin{enumerate}
\item (second inequality) $ \#H^2(G, \CC_L) \le \#G $, and
\item (first inequality) $ \#H^2(G, \CC_L) \ge \#G $ if $ G $ is cyclic.
\end{enumerate}
\end{theorem}

In particular, T1 holds for $ \CC_L $, and T2 holds for $ \CC_L $ if $ G $ is cyclic.

\bigskip The short exact sequence $ 1 \to L^\times \xrightarrow{\Delta} \II_L \to \CC_L \to 0 $ induces
$$ \overset{0}{\cancel{H^1(G, \CC_L)}} \to H^2(G, L^\times) \xrightarrow{\overline{\Delta}} H^2(G, \II_L) \to H^2(G, \CC_L). $$
Thus there are inequalities
$$ \#\coker(\overline{\Delta}) \le \#H^2(G, \CC_L) \le \#G, $$
where the right inequality is an equality if $ G $ is cyclic.

\end{frame}

\begin{frame}{The id\`elic invariant map}

\begin{corollary}
Let $ L / K $ be a finite extension of number fields with Galois group $ G $.
\begin{enumerate}
\item There are canonical isomorphisms $ H^i(G, \II_L) \cong \bigoplus_v H^i(G_v, L_w^\times) $ for all $ i > 0 $. In particular, there is an \textbf{id\`elic invariant map}
$$ \sum_v \inv_v : H^2(G, \II_L) \to \tfrac{1}{\lcm_v(\#G_v)}\Z / \Z. $$
\item If $ a \in H^2(G, L^\times) $, then $ \sum_v \inv_v(a) = 0 $.
\item If $ G $ is cyclic, then $ \sum_v \inv_v $ surjects onto $ \tfrac{1}{\#G}\Z / \Z $.
\end{enumerate}
\end{corollary}

\begin{proof}
\begin{enumerate}
\item Follows from the cohomology of unramified units.
\item Follows from the product formula and explicit description of $ \inv_v $.
\item Follows from Chebotarev's density theorem and surjectivity of $ \inv_v $.
\end{enumerate}
\end{proof}

\end{frame}

\begin{frame}{Back to the fundamental exact sequence}

In summary, if $ G $ is cyclic, there is a chain complex
$$ 0 \to H^2(G, L^\times) \xrightarrow{\overline{\Delta}} H^2(G, \II_L) \xrightarrow{\sum_v \inv_v} \tfrac{1}{\#G}\Z / \Z \to 0, $$
which is exact except possibly at the middle. However, it is also exact by
$$ \#G \le \#\coker(\overline{\Delta}) \le \#H^2(G, \CC_L) = \#G. $$
On the other hand, recall that
$$ \Br(L / K) = H^2(G, L^\times), \qquad \Br(L_w / K_v) = H^2(G_v, L_w^\times). $$
This proves that the sequence
$$ 0 \to \Br(L / K) \xrightarrow{\overline{\Delta}} \bigoplus_v \Br(L_w / K_v) \xrightarrow{\sum_v \inv_v} \tfrac{1}{\#G}\Z / \Z \to 0 $$
is exact.

\end{frame}

\end{document}